H5PEditor.FileUploader=function(e,o){function t(e){var t=this;o.call(t),t.upload=function(o,n){const r=new Headers;r.append("field",JSON.stringify(e)),r.append("contentId",H5PEditor.contentId||0);var i=new XMLHttpRequest;i.onload=function(){var e,n={error:null,data:null};try{const r=(e=JSON.parse(i.responseText)).uploadURL,a=e.displayURL,d=new XMLHttpRequest;(new FormData).append("file",o),r&&(d.open("PUT",r,!0),d.send(o),d.upload.onprogress=function(e){e.lengthComputable&&t.trigger("uploadProgress",e.loaded/e.total)},d.onload=function(){n.data={path:`${a}#tmp`,mime:"image/png"},t.trigger("uploadComplete",n)})}catch(e){H5P.error(e),n.error=H5PEditor.t("core","fileToLarge")}void 0!==e&&(void 0!==e.error&&(n.error=e.error),!1===e.success&&(n.error=e.message?e.message:H5PEditor.t("core","unknownFileUploadError"))),null===n.error&&(n.data=e)},i.open("POST","https://eu-west-1-production-apis.toddleapp.com/auth/generateS3SignedURL",!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send("fileMimeType=image%2Fpng"),t.trigger("upload")},t.uploadFiles=function(e){t.upload(e[0],e[0].name)},t.openFileSelector=function(){const e=document.createElement("input");e.type="file",e.setAttribute("accept",n()),e.style="display:none",e.addEventListener("change",(function(){t.uploadFiles(this.files),document.body.removeChild(e)})),document.body.appendChild(e),e.click()};const n=function(){if(e.mimes)return e.mimes.join(",");switch(e.type){case"image":return"image/jpeg,image/png,image/gif";case"audio":return"audio/mpeg,audio/x-wav,audio/ogg,audio/mp4";case"video":return"video/mp4,video/webm,video/ogg"}}}return t.prototype=Object.create(o.prototype),t.prototype.constructor=t,t}(H5P.jQuery,H5P.EventDispatcher);