ns.Number=function(e,t,i,r){this.field=t,this.value=i,this.setValue=r},ns.Number.prototype.appendTo=function(e){var t=this;this.$item=ns.$(this.createHtml()).appendTo(e),this.$errors=this.$item.find(".h5p-errors");var i=this.$item.find("input");1===i.length?this.$input=i:(this.$range=i.filter(":first"),this.$input=this.$range.next()),this.$input.change((function(){var e=t.validate();!1!==e&&(t.value=e,t.setValue(t.field,e),void 0!==t.$range&&t.$range.val(e),void 0!==e&&t.field.unit&&t.$input.val(e+" "+t.field.unit))})),void 0!==this.$range&&("range"===this.$range.attr("type")?(this.$range.change((function(){t.$input.val(t.$range.val()).change()})),H5PEditor.isIE&&(this.$range.css("margin-top",0),this.$input.css("margin-top","7px"))):this.$range.remove())},ns.Number.prototype.createHtml=function(){const e=ns.getNextFieldId(this.field),t=void 0!==this.field.description?ns.getDescriptionId(e):void 0,i=this.field.unit&&void 0!==this.value?this.value+" "+this.field.unit:this.value;var r=ns.createText(i,15,void 0,e,t);return ns.createFieldMarkup(this.field,r,e)},ns.Number.prototype.validate=function(){var e=this,t=H5P.trim(this.$input.val()),i=void 0!==this.field.decimals&&this.field.decimals;this.field.unit&&(t=t.replace(new RegExp(" *"+this.field.unit+"$"),"")),this.$errors.html("");var r=0===e.field.label?ns.t("core","numberField"):e.field.label;if(t.length){var s=t.match(new RegExp("^-?[0-9]+$"));!i||s||t.match(new RegExp("^-?[0-9]+(.|,)[0-9]{1,"+i+"}$"))?i||s?(t=i?parseFloat(t.replace(",",".")):parseInt(t),void 0!==this.field.max&&t>this.field.max?this.$errors.append(ns.createError(ns.t("core","exceedsMax",{":property":r,":max":this.field.max}))):void 0!==this.field.min&&t<this.field.min?this.$errors.append(ns.createError(ns.t("core","belowMin",{":property":r,":min":this.field.min}))):void 0!==this.field.step&&t%this.field.step&&this.$errors.append(ns.createError(ns.t("core","outOfStep",{":property":r,":step":this.field.step})))):this.$errors.append(ns.createError(ns.t("core","onlyNumbers",{":property":r}))):this.$errors.append(ns.createError(ns.t("core","illegalDecimalNumber",{":property":r,":decimals":i})))}else{if(!0===e.field.optional)return void this.$input.removeClass("error");this.$errors.append(ns.createError(ns.t("core","requiredProperty",{":property":ns.t("core","numberField")})))}return this.$input.toggleClass("error",this.$errors.html().length>0),ns.checkErrors(this.$errors,this.$input,t)},ns.Number.prototype.remove=function(){this.$item.remove()},ns.widgets.number=ns.Number;